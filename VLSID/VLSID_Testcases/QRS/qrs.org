"qrs.org"
q00 1 - | rdy=0,RRpeak=0,fl3o=0,RRo=0,y0m1=0,y0m2=0,ymax=0,xmax=0,zmax=0,RR=0,lymax=0,lzmax=0,lxmax=0,fl3=0,fl1=0,fl2=0,count=0 q01 ;
q01 1 - | rdy=1 q02 ;
q02 1 - | low=data,rdy=0 q03 ;
q03 1 - | rdy=1 q04 ;
q04 1 - | high=data,rdy=0 q05 ;
q05 1 - | rdy=1 q06 ;
q06 1 - | indx=data,rdy=0 q07 ;
q07 1 - | rdy=1 q08 ;
q08 1 - | ftm1=data q09 ;
q09 1 - | ecgm1=ftm1,i=1 q010 ;
q010 2 i<=indx | rdy=0 q011 !i<=indx | - q030 ;
q011 1 - | rdy=1,i=i+1 q012 ;
q012 1 - | ecg1=data q013 ;
q013 1 - | t1=ecg1-ecgm1,t2=ecg1-ecgm1 q014 ;
q014 1 - | t3=t2/256,t4=ftm1+t1 q015 ;
q015 1 - | ft=ftm1 q017 ;
q017 1 - | ysi=ft-ftm2 q018 ;
q018 2 ysi>ymax | ymax=ysi q019 !ysi>ymax | - q019 ;
q019 2 ft>xmax | xmax=ft q020 !ft>xmax | - q020 ;
q020 2 ft>0 | y0=ft q021 !ft>0 | - q021  ;
q021 1 - | ath=xmax/4 q023 ;
q023 2 ath>y0 | y0=ath q024 !ath>y0 | - q024 ;
q024 1 - | ys=y0-y0m2 q025 ;
q025 2 ys>zmax | zmax=ys q026 !ys>zmax | - q026 ;
q026 1 - | ftm2=ftm1,ftm1=ft,ecgm1=data,y0m2=y0m1,y0m1=y0,t5=ymax/2,t6=ymax/8,t7=ymax/16,t8=zmax/2,t9=zmax/8,t10=zmax/16 q027 ;
q027 1 - | t11=t5+t6,t12=t8+t9 q028 ;
q028 1 - | sth2=t12+t10 q030 ;
q030 2 ysi>sth1 | fl1=0,count=0 q031 !ysi>sth1 | - q031 ;
q031 2 ys>sth2 | fl2=0,count=0 q032 !ys>sth2 | - q032 ;
q032 2 fl1==1&&fl2==1&&RR>low | RRpeak=1,t13=xmax/2,t14=xmax/4,t15=lxmax/8,t16=ymax/2,t17=ymax/4,t18=lymax/8,t19=zmax/2,t20=zmax/4,t21=lzmax/8 q033 !fl1==1&&fl2==1&&RR>low | RRpeak=0 q036 ;
q033 1 - | t22=t13+t14,t23=t16+t17,t24=t19+t20 q035 ;
q035 1 - | RR=0,count=0,fl1=0,fl2=0,fl3=0,lxmax=0,lymax=0,lzmax=0 q036 ;
q036 2 fl1==1||fl2==1 | count=count+1 q037 !fl1==1||fl2==1 | - q037 ;
q037 1 - | fl3o=fl3,RRo=RR,rdy2=0 q038 ;
q038 1 - | rdy2=1,ecg1=data q039 ;
q039 1 - | t1=ecg1-ecgm1 q040 ;
q040 1 - | t2=t1/256,t4=ftm1+t1 q041 ;
q041 1 - | ysi=ft-ftm2 q042 ;
q042 2 ysi>lymax | lymax=ysi q043 !ysi>lymax | - q043 ;
q043 2 ft>lxmax | lxmax=ft q044 !ft>lxmax | - q044 ;
q044 2 ft>0 | y0=ft q045 !ft>0 | - q045 ;
q045 1 - | ath=xmax/4 q046 ;
q046 2 y0<ath | y0=ath q047 !y0<ath | - q047 ;
q047 1 - | ys=y0-y0m2 q048 ;
q048 2 ys>lzmax | lzmax=ys q049 !ys>lzmax | - q049 ;
q049 2 count==8 | fl1=0,fl2=0,count=0 q050 !count==8 | - q050 ;
q050 2 RR>high | fl3=fl3+1,RR=0,ymax=ymax/2,zmax=zmax/2 q051 !RR>high | - q051 ;
q051 1 - | t5=ymax/2,t6=ymax/8,t7=ymax/16,t8=zmax/2,t9=zmax/8,t10=zmax/16 q052 ;
q052 1 - | t11=t5+t6,t12=t8+t9 q053 ;
q053 0 ;
